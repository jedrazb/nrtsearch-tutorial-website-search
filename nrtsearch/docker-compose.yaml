version: "3.7"

services:
  primary-node:
    build: ./
    container_name: primary-node
    command: >
      bash -c "/user/nrtsearch/build/install/nrtsearch/bin/lucene-server /user/nrtsearch/nrtsearch-primary-config.yaml"
    hostname: primary-node
    ports:
      - "9000:8000"

  replica-node:
    build: ./
    command: ./entrypoint_replica.sh
    deploy:
      replicas: 2
    ports:
      - "9001-9002:8000"
